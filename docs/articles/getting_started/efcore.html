<!DOCTYPE html>

<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Getting Started with RestModels and Entity Framework Core </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Getting Started with RestModels and Entity Framework Core ">
    <meta name="generator" content="docfx 2.52.0.0">
    
    <link rel="shortcut icon" href="../../favicon.png">
    <link rel="stylesheet" href="../../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../../styles/docfx.css">
    <link rel="stylesheet" href="../../styles/main.css">
    <meta property="docfx:navrel" content="../../toc.html">
    <meta property="docfx:tocrel" content="toc.html">
    
    
    
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../../index.html">
                <img id="logo" class="svg" src="../../favicon.png" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="getting-started">
<h1 id="getting-started-with-restmodels-and-entity-framework-core">Getting Started with RestModels and Entity Framework Core</h1>

<p>In this getting started example, we'll be building a simple API for a blog server. When you're finished, you'll be able to create, read, update, and delete blogs and blog posts with simple key-based authentication.</p>
<h2 id="terminology">Terminology</h2>
<p>Some of the terms used in this article can mean a lot of different things in a lot of different places, so here's a quick breakdown of what they mean in this article:</p>
<ul>
<li><strong>API:</strong> Every call to some form of <code>app.UseRestModels</code> is an &quot;API,&quot; a set of routes bundled together for working with a specific model.</li>
<li><strong>Model:</strong> The data class that the API operates on. In Entity Framework, this is also referred to as an Entity.</li>
<li><strong>Route:</strong> A bundle of all the options for a request with a single associated route pattern {todo fix - im having a hard time explaining this}</li>
<li><strong>Route Pattern:</strong> The string pattern that determines whether an HTTP request path matches a route</li>
</ul>
<h2 id="prerequisites">Prerequisites</h2>
<ul>
<li><a href="https://visualstudio.microsoft.com/">Visual Studio with .NET Core</a> (Windows) or <a href="https://code.visualstudio.com/">Visual Studio Code</a> and the <a href="https://www.microsoft.com/net/download/core">.NET Core SDK</a> (Windows, Mac, Linux)</li>
<li>A good knowledge of ASP.NET Core and Entity Framework is recommended, but not required.</li>
</ul>
<h2 id="creating-a-new-project">Creating a new Project</h2>
<p>Step one is creating a new ASP.NET Core project in Visual Studio, or on the command line.</p>
<div class="tabGroup" id="tabgroup_CeZOj-G++Q">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_CeZOj-G++Q_vs" role="tab" aria-controls="tabpanel_CeZOj-G++Q_vs" data-tab="vs" tabindex="0" aria-selected="true">Visual Studio 2019</a>
</li>
<li role="presentation">
<a href="#tabpanel_CeZOj-G++Q_cli" role="tab" aria-controls="tabpanel_CeZOj-G++Q_cli" data-tab="cli" tabindex="-1">Command Line</a>
</li>
</ul>
<section id="tabpanel_CeZOj-G++Q_vs" role="tabpanel" data-tab="vs">

<ul>
<li>From the Start Page, click on <strong>Create a new project</strong></li>
<li>Click on or search for <strong>ASP.NET Core Web Application</strong></li>
<li>Enter a suitable project name, like <strong>RMGettingStarted</strong></li>
<li>Click <strong>Create</strong></li>
</ul>
</section>
<section id="tabpanel_CeZOj-G++Q_cli" role="tabpanel" data-tab="cli" aria-hidden="true" hidden="hidden">

<p>Create a new folder for your project, and a new web application with <code>dotnet</code>:</p>
<pre><code class="lang-bash">~$ mkdir BlogServer &amp;&amp; cd BlogServer
~/BlogServer$ dotnet new web
</code></pre>
</section>
</div>
<h2 id="installing-dependencies">Installing Dependencies</h2>
<p>Next, install the <code>RestModels.EntityFrameworkCore</code> nuget package, as well as the Entity Framework package for your database. In this example, we'll be using <code>Sqlite</code>.</p>
<div class="tabGroup" id="tabgroup_CeZOj-G++Q-1">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_CeZOj-G++Q-1_vs" role="tab" aria-controls="tabpanel_CeZOj-G++Q-1_vs" data-tab="vs" tabindex="0" aria-selected="true">Visual Studio 2019</a>
</li>
<li role="presentation">
<a href="#tabpanel_CeZOj-G++Q-1_cli" role="tab" aria-controls="tabpanel_CeZOj-G++Q-1_cli" data-tab="cli" tabindex="-1">Command Line</a>
</li>
</ul>
<section id="tabpanel_CeZOj-G++Q-1_vs" role="tabpanel" data-tab="vs">

<ul>
<li>From the toolbar, select <strong>Tools</strong> &gt; <strong>NuGet Package Manager</strong> &gt; <strong>Package Manager Console</strong></li>
<li>Enter the following commands in the Package Manager Console:</li>
</ul>
<pre><code class="lang-powershell">Install-Package Microsoft.EntityFrameworkCore.Sqlite
Install-Package RestModels.EntityFrameworkCore
</code></pre>
</section>
<section id="tabpanel_CeZOj-G++Q-1_cli" role="tabpanel" data-tab="cli" aria-hidden="true" hidden="hidden">

<pre><code class="lang-bash">dotnet add package Microsoft.EntityFrameworkCore.Sqlite
dotnet add package RestModels.EntityFrameworkCore
</code></pre>
</section>
</div>

<p>Once you've installed the package, go ahead and build the project (<code>Shift+F6</code> or <code>dotnet build</code>) to make sure everything's set up properly.</p>
<h2 id="creating-a-model">Creating A Model</h2>
<p>Next, we'll create the models for our blog server, based on the classes in EF Core's <a href="https://docs.microsoft.com/en-us/ef/core/get-started/">getting started guide</a>.</p>
<div class="tabGroup" id="tabgroup_CeZOj-G++Q-2">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_CeZOj-G++Q-2_cs" role="tab" aria-controls="tabpanel_CeZOj-G++Q-2_cs" data-tab="cs" tabindex="0" aria-selected="true">Blog.cs</a>
</li>
</ul>
<section id="tabpanel_CeZOj-G++Q-2_cs" role="tabpanel" data-tab="cs">

<pre><code class='lang-csharp'><span style='color:#AF00DB;'>using</span><span style='color:black;'> </span><span style='color:#267F99;'>System</span><span style='color:black;'>.</span><span style='color:#267F99;'>Collections</span><span style='color:black;'>.</span><span style='color:#267F99;'>Generic</span><span style='color:#222222;'>;</span><br /><span style='color:#0000FF;'>namespace</span><span style='color:black;'> </span><span style='color:#267F99;'>BlogServer</span><span style='color:black;'> </span><span style='color:#222222;'>{</span><br /><span style='color:black;'>    </span><span style='color:#0000FF;'>public</span><span style='color:black;'> </span><span style='color:#0000FF;'>class</span><span style='color:black;'> </span><span style='color:#267F99;'>Blog</span><span style='color:black;'> </span><span style='color:#222222;'>{</span><br /><span style='color:black;'>        </span><span style='color:#0000FF;'>public</span><span style='color:black;'> </span><span style='color:#0000FF;'>int</span><span style='color:black;'> </span><span style='color:#001080;'>BlogId</span><span style='color:black;'> </span><span style='color:#222222;'>{</span><span style='color:black;'> </span><span style='color:#0000FF;'>get</span><span style='color:#222222;'>;</span><span style='color:black;'> </span><span style='color:#0000FF;'>set</span><span style='color:#222222;'>;</span><span style='color:black;'> </span><span style='color:#222222;'>}</span><br /><span style='color:black;'>        </span><span style='color:#0000FF;'>public</span><span style='color:black;'> </span><span style='color:#0000FF;'>string</span><span style='color:black;'> </span><span style='color:#001080;'>Url</span><span style='color:black;'> </span><span style='color:#222222;'>{</span><span style='color:black;'> </span><span style='color:#0000FF;'>get</span><span style='color:#222222;'>;</span><span style='color:black;'> </span><span style='color:#0000FF;'>set</span><span style='color:#222222;'>;</span><span style='color:black;'> </span><span style='color:#222222;'>}</span><br /><span style='color:black;'></span><br /><span style='color:black;'>        </span><span style='color:#0000FF;'>public</span><span style='color:black;'> </span><span style='color:#267F99;'>List</span><span style='color:#222222;'>&lt;</span><span style='color:#267F99;'>Post</span><span style='color:#222222;'>&gt;</span><span style='color:black;'> </span><span style='color:#001080;'>Posts</span><span style='color:black;'> </span><span style='color:#222222;'>{</span><span style='color:black;'> </span><span style='color:#0000FF;'>get</span><span style='color:#222222;'>;</span><span style='color:black;'> </span><span style='color:#222222;'>}</span><span style='color:black;'> </span><span style='color:#000000;'>=</span><span style='color:black;'> </span><span style='color:#0000FF;'>new</span><span style='color:black;'> </span><span style='color:#267F99;'>List</span><span style='color:#222222;'>&lt;</span><span style='color:#267F99;'>Post</span><span style='color:#222222;'>&gt;</span><span style='color:#222222;'>(</span><span style='color:#222222;'>)</span><span style='color:#222222;'>;</span><br /><span style='color:black;'>    </span><span style='color:#222222;'>}</span><br /><span style='color:black;'></span><br /><span style='color:black;'>    </span><span style='color:#0000FF;'>public</span><span style='color:black;'> </span><span style='color:#0000FF;'>class</span><span style='color:black;'> </span><span style='color:#267F99;'>Post</span><span style='color:black;'> </span><span style='color:#222222;'>{</span><br /><span style='color:black;'>        </span><span style='color:#0000FF;'>public</span><span style='color:black;'> </span><span style='color:#0000FF;'>int</span><span style='color:black;'> </span><span style='color:#001080;'>PostId</span><span style='color:black;'> </span><span style='color:#222222;'>{</span><span style='color:black;'> </span><span style='color:#0000FF;'>get</span><span style='color:#222222;'>;</span><span style='color:black;'> </span><span style='color:#0000FF;'>set</span><span style='color:#222222;'>;</span><span style='color:black;'> </span><span style='color:#222222;'>}</span><br /><span style='color:black;'>        </span><span style='color:#0000FF;'>public</span><span style='color:black;'> </span><span style='color:#0000FF;'>string</span><span style='color:black;'> </span><span style='color:#001080;'>Title</span><span style='color:black;'> </span><span style='color:#222222;'>{</span><span style='color:black;'> </span><span style='color:#0000FF;'>get</span><span style='color:#222222;'>;</span><span style='color:black;'> </span><span style='color:#0000FF;'>set</span><span style='color:#222222;'>;</span><span style='color:black;'> </span><span style='color:#222222;'>}</span><br /><span style='color:black;'>        </span><span style='color:#0000FF;'>public</span><span style='color:black;'> </span><span style='color:#0000FF;'>string</span><span style='color:black;'> </span><span style='color:#001080;'>Content</span><span style='color:black;'> </span><span style='color:#222222;'>{</span><span style='color:black;'> </span><span style='color:#0000FF;'>get</span><span style='color:#222222;'>;</span><span style='color:black;'> </span><span style='color:#0000FF;'>set</span><span style='color:#222222;'>;</span><span style='color:black;'> </span><span style='color:#222222;'>}</span><br /><span style='color:black;'></span><br /><span style='color:black;'>        </span><span style='color:#0000FF;'>public</span><span style='color:black;'> </span><span style='color:#0000FF;'>int</span><span style='color:black;'> </span><span style='color:#001080;'>BlogId</span><span style='color:black;'> </span><span style='color:#222222;'>{</span><span style='color:black;'> </span><span style='color:#0000FF;'>get</span><span style='color:#222222;'>;</span><span style='color:black;'> </span><span style='color:#0000FF;'>set</span><span style='color:#222222;'>;</span><span style='color:black;'> </span><span style='color:#222222;'>}</span><br /><span style='color:black;'>        </span><span style='color:#0000FF;'>public</span><span style='color:black;'> </span><span style='color:#267F99;'>Blog</span><span style='color:black;'> </span><span style='color:#001080;'>Blog</span><span style='color:black;'> </span><span style='color:#222222;'>{</span><span style='color:black;'> </span><span style='color:#0000FF;'>get</span><span style='color:#222222;'>;</span><span style='color:black;'> </span><span style='color:#0000FF;'>set</span><span style='color:#222222;'>;</span><span style='color:black;'> </span><span style='color:#222222;'>}</span><br /><span style='color:black;'>    </span><span style='color:#222222;'>}</span><br /><span style='color:#222222;'>}</span><br /><span style='color:black;'></span></code></pre>
</section>
</div>
<h2 id="setting-up-ef-core">Setting up EF Core</h2>
<p>Set up Entity Framework with a <code>BlogServerContext</code> as you normally would. Here's the context this guide will use:</p>
<div class="tabGroup" id="tabgroup_CeZOj-G++Q-3">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_CeZOj-G++Q-3_cs" role="tab" aria-controls="tabpanel_CeZOj-G++Q-3_cs" data-tab="cs" tabindex="0" aria-selected="true">BlogServerContext.cs</a>
</li>
</ul>
<section id="tabpanel_CeZOj-G++Q-3_cs" role="tabpanel" data-tab="cs">

<pre><code class='lang-csharp'><span style='color:#AF00DB;'>using</span><span style='color:black;'> </span><span style='color:#267F99;'>Microsoft</span><span style='color:black;'>.</span><span style='color:#267F99;'>EntityFrameworkCore</span><span style='color:#222222;'>;</span><br /><span style='color:#0000FF;'>namespace</span><span style='color:black;'> </span><span style='color:#267F99;'>BlogServer</span><span style='color:black;'> </span><span style='color:#222222;'>{</span><br /><span style='color:black;'>    </span><span style='color:#0000FF;'>public</span><span style='color:black;'> </span><span style='color:#0000FF;'>class</span><span style='color:black;'> </span><span style='color:#267F99;'>BlogServerContext</span><span style='color:black;'> </span><span style='color:#222222;'>:</span><span style='color:black;'> </span><span style='color:#267F99;'>DbContext</span><br /><span style='color:black;'>    </span><span style='color:#222222;'>{</span><br /><span style='color:black;'>        </span><span style='color:#0000FF;'>public</span><span style='color:black;'> </span><span style='color:#267F99;'>DbSet</span><span style='color:#222222;'>&lt;</span><span style='color:#267F99;'>Blog</span><span style='color:#222222;'>&gt;</span><span style='color:black;'> </span><span style='color:#001080;'>Blogs</span><span style='color:black;'> </span><span style='color:#222222;'>{</span><span style='color:black;'> </span><span style='color:#0000FF;'>get</span><span style='color:#222222;'>;</span><span style='color:black;'> </span><span style='color:#0000FF;'>set</span><span style='color:#222222;'>;</span><span style='color:black;'> </span><span style='color:#222222;'>}</span><br /><span style='color:black;'>        </span><span style='color:#0000FF;'>public</span><span style='color:black;'> </span><span style='color:#267F99;'>DbSet</span><span style='color:#222222;'>&lt;</span><span style='color:#267F99;'>Post</span><span style='color:#222222;'>&gt;</span><span style='color:black;'> </span><span style='color:#001080;'>Posts</span><span style='color:black;'> </span><span style='color:#222222;'>{</span><span style='color:black;'> </span><span style='color:#0000FF;'>get</span><span style='color:#222222;'>;</span><span style='color:black;'> </span><span style='color:#0000FF;'>set</span><span style='color:#222222;'>;</span><span style='color:black;'> </span><span style='color:#222222;'>}</span><br /><span style='color:black;'></span><br /><span style='color:black;'>        </span><span style='color:#0000FF;'>protected</span><span style='color:black;'> </span><span style='color:#0000FF;'>override</span><span style='color:black;'> </span><span style='color:#0000FF;'>void</span><span style='color:black;'> </span><span style='color:#795E26;'>OnConfiguring</span><span style='color:#222222;'>(</span><span style='color:#267F99;'>DbContextOptionsBuilder</span><span style='color:black;'> </span><span style='color:#001080;'>options</span><span style='color:#222222;'>)</span><br /><span style='color:black;'>            </span><span style='color:#000000;'>=&gt;</span><span style='color:black;'> </span><span style='color:#001080;'>options</span><span style='color:#222222;'>.</span><span style='color:#795E26;'>UseSqlite</span><span style='color:#222222;'>(</span><span style='color:#A31515;'>&quot;</span><span style='color:#A31515;'>Data Source=blogging.db</span><span style='color:#A31515;'>&quot;</span><span style='color:#222222;'>)</span><span style='color:#222222;'>;</span><br /><span style='color:black;'>    </span><span style='color:#222222;'>}</span><br /><span style='color:#222222;'>}</span><br /><span style='color:black;'></span></code></pre>
</section>
</div>

<p>Register the DbContext Service in the <code>ConfigureServices</code> method of <code>Startup.cs</code>:</p>
<pre><code class='lang-csharp'><span style='color:#001080;'>services</span><span style='color:#222222;'>.</span><span style='color:#795E26;'>AddDbContext</span><span style='color:#222222;'>&lt;</span><span style='color:#267F99;'>BlogServerContext</span><span style='color:#222222;'>&gt;</span><span style='color:#222222;'>(</span><span style='color:#222222;'>)</span><span style='color:#222222;'>;</span><span style='color:black;'> </span><span style='color:#008000;'>//</span><span style='color:#008000;'> { todo -- better error when missing }</span><br /><span style='color:black;'></span></code></pre>
<p>Then, create a migration and the database:</p>
<div class="tabGroup" id="tabgroup_CeZOj-G++Q-4">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_CeZOj-G++Q-4_vs" role="tab" aria-controls="tabpanel_CeZOj-G++Q-4_vs" data-tab="vs" tabindex="0" aria-selected="true">Visual Studio 2019</a>
</li>
<li role="presentation">
<a href="#tabpanel_CeZOj-G++Q-4_cli" role="tab" aria-controls="tabpanel_CeZOj-G++Q-4_cli" data-tab="cli" tabindex="-1">Command Line</a>
</li>
</ul>
<section id="tabpanel_CeZOj-G++Q-4_vs" role="tabpanel" data-tab="vs">

<p>In the Package Manager Console, run the following:</p>
<pre><code class="lang-powershell">Install-Package Microsoft.EntityFrameworkCore.Tools
Add-Migration InitialCreate
Update-Database
</code></pre>
<p>For more details on what these commands are doing, refer to EF Core's <a href="https://docs.microsoft.com/en-us/ef/core/get-started/?tabs=visual-studio#tabpanel_CeZOj-G++Q-4_visual-studio">getting started guide</a></p>
</section>
<section id="tabpanel_CeZOj-G++Q-4_cli" role="tabpanel" data-tab="cli" aria-hidden="true" hidden="hidden">

<pre><code class="lang-bash">dotnet tool install --global dotnet-ef
dotnet add package Microsoft.EntityFrameworkCore.Design
dotnet ef migrations add InitialCreate
dotnet ef database update
</code></pre>
<p>For more details on what these commands are doing, refer to EF Core's <a href="https://docs.microsoft.com/en-us/ef/core/get-started/?tabs=netcore-cli#tabpanel_CeZOj-G++Q-4_netcore-cli">getting started guide</a></p>
</section>
</div>
<h2 id="building-the-blog-api">Building the <code>Blog</code> API</h2>
<p>Now that we have our model and EF Core set up, we can start building our Blog API.</p>
<p>In  <code>Startup.cs</code>, add the following code to the end of the <code>Configure</code> method:</p>
<pre><code class='lang-csharp'><span style='color:#0000FF;'>string</span><span style='color:black;'> </span><span style='color:#001080;'>AdminKey</span><span style='color:black;'> </span><span style='color:#000000;'>=</span><span style='color:black;'> </span><span style='color:#A31515;'>&quot;</span><span style='color:#A31515;'>mysecretkey</span><span style='color:#A31515;'>&quot;</span><span style='color:#222222;'>;</span><br /><span style='color:#001080;'>app</span><span style='color:#222222;'>.</span><span style='color:#795E26;'>UseEntityFrameworkRestModels</span><span style='color:#222222;'>&lt;</span><span style='color:#267F99;'>Blog</span><span style='color:#222222;'>,</span><span style='color:black;'> </span><span style='color:#267F99;'>BlogServerContext</span><span style='color:#222222;'>&gt;</span><span style='color:#222222;'>(</span><span style='color:#A31515;'>&quot;</span><span style='color:#A31515;'>blog</span><span style='color:#A31515;'>&quot;</span><span style='color:#222222;'>,</span><span style='color:black;'> </span><span style='color:#001080;'>options</span><span style='color:black;'> </span><span style='color:#000000;'>=&gt;</span><span style='color:black;'> </span><span style='color:#222222;'>{</span><br /><span style='color:black;'>    </span><span style='color:#001080;'>options</span><br /><span style='color:black;'>        </span><span style='color:#222222;'>.</span><span style='color:#795E26;'>ParseJson</span><span style='color:#222222;'>(</span><span style='color:#222222;'>)</span><span style='color:black;'> </span><span style='color:#008000;'>//</span><span style='color:#008000;'> parse JSON for request bodies</span><br /><span style='color:black;'>        </span><span style='color:#222222;'>.</span><span style='color:#795E26;'>WriteJson</span><span style='color:#222222;'>(</span><span style='color:#222222;'>)</span><span style='color:black;'> </span><span style='color:#008000;'>//</span><span style='color:#008000;'> output JSON responses</span><br /><span style='color:black;'>        </span><span style='color:#222222;'>.</span><span style='color:#795E26;'>Omit</span><span style='color:#222222;'>(</span><span style='color:#001080;'>m</span><span style='color:black;'> </span><span style='color:#000000;'>=&gt;</span><span style='color:black;'> </span><span style='color:#001080;'>m</span><span style='color:#222222;'>.</span><span style='color:#001080;'>Posts</span><span style='color:#222222;'>)</span><span style='color:black;'> </span><span style='color:#008000;'>//</span><span style='color:#008000;'> don&#39;t include posts in the response JSON</span><br /><span style='color:black;'>        </span><span style='color:#222222;'>.</span><span style='color:#795E26;'>CatchExceptions</span><span style='color:#222222;'>(</span><span style='color:#222222;'>)</span><span style='color:black;'> </span><span style='color:#008000;'>//</span><span style='color:#008000;'> show error messages </span><br /><span style='color:black;'>        </span><span style='color:#222222;'>.</span><span style='color:#795E26;'>GetByPrimaryKey</span><span style='color:#222222;'>(</span><span style='color:#222222;'>)</span><span style='color:black;'> </span><span style='color:#008000;'>//</span><span style='color:#008000;'> GET /blog/{id}</span><br /><span style='color:black;'>        </span><span style='color:#222222;'>.</span><span style='color:#795E26;'>AuthQuery</span><span style='color:#222222;'>(</span><span style='color:#A31515;'>&quot;</span><span style='color:#A31515;'>key</span><span style='color:#A31515;'>&quot;</span><span style='color:#222222;'>,</span><span style='color:black;'> </span><span style='color:#001080;'>AdminKey</span><span style='color:#222222;'>)</span><span style='color:black;'> </span><span style='color:#008000;'>//</span><span style='color:#008000;'> require authentication for all future routes</span><br /><span style='color:black;'>        </span><span style='color:#222222;'>.</span><span style='color:#795E26;'>PostCreate</span><span style='color:#222222;'>(</span><span style='color:#222222;'>)</span><span style='color:black;'> </span><span style='color:#008000;'>//</span><span style='color:#008000;'> POST /blog</span><br /><span style='color:black;'>        </span><span style='color:#222222;'>.</span><span style='color:#795E26;'>PutUpdateByPrimaryKey</span><span style='color:#222222;'>(</span><span style='color:#222222;'>)</span><span style='color:black;'> </span><span style='color:#008000;'>//</span><span style='color:#008000;'> PUT /blog/{id}</span><br /><span style='color:black;'>        </span><span style='color:#222222;'>.</span><span style='color:#795E26;'>DeleteByPrimaryKey</span><span style='color:#222222;'>(</span><span style='color:#222222;'>)</span><span style='color:#222222;'>;</span><span style='color:black;'> </span><span style='color:#008000;'>//</span><span style='color:#008000;'> DELETE /blog/{id}</span><br /><span style='color:#222222;'>}</span><span style='color:#222222;'>)</span><span style='color:#222222;'>;</span><br /><span style='color:black;'></span></code></pre>
<div class="IMPORTANT">
<h5>Important</h5>
<p>Make sure you add <code>using RestModels.Extensions;</code> and <code>using RestModels.EntityFrameworkCore.Extensions;</code> to the top of the file, otherwise the build will fail.</p>
</div>
<p>This defines an API on the <code>/blog</code> route, which can create, read, update, and delete Blogs. Notice that child routes inherit the properties of their parent routes by default. For example, all of the <code>GET</code>/<code>POST</code>/<code>PUT</code>/<code>DELETE</code> requests will omit the <code>Posts</code> property from their response because the <code>Omit</code> method was called on the base route.
{{Sometimes, however, a method like <code>GetByPrimaryKey</code> will clear all body parsers for that route, because it doesn't make sense to parse a body for a <code>GET</code> request. -- todo: article w/ more in-depth exploration of this topic, maybe delete this confusing sentence entirely}}</p>
<div class="NOTE">
<h5>Note</h5>
<p>Order is important when creating APIs. In the API above, the <code>AuthQuery</code> method only applies to the create, update, and delete requests following it. The <code>GET</code> request before it has no authentication.</p>
</div>
<div class="IMPORTANT">
<h5>Important</h5>
<p><strong>Never</strong> hardcode an API key in code. <code>AdminKey</code> is only used in this guide for simplicity.</p>
</div>
<h2 id="running-the-project">Running the Project</h2>
<p>At this point, run the project to better understand what you've built so far. To run the app, hit the play button in Visual Studio, or run <code>dotnet run</code> in the command line. While you can try to explore the <code>GET</code> request in the browser, you'll need a tool like <a href="https://insomnia.rest/">Insomnia</a> or <a href="https://www.postman.com/">Postman</a> to test the <code>POST</code>, <code>PUT</code>, and <code>DELETE</code> requests.</p>
<div class="NOTE">
<h5>Note</h5>
<p>You'll likely immediately notice that visting just <code>/blog</code> in your web browser returns a <code>405 Method Not Allowed</code> response. That's because no routes matching it have a <code>GET</code> request method associated with them. You can add a request method manually with <a class="xref" href="../../api/RestModels.Options.Builder.RestModelOptionsBuilder-2.html#RestModels_Options_Builder_RestModelOptionsBuilder_2_AddRequestMethod_System_String_">AddRequestMethod(String)</a>, but it's generally recommended to use the <code>options.SetupMETHOD</code> and <code>options.METHOD</code> methods instead like we did here. For more information on routing, see <a class="xref" href="../request_flow/routing.html">routing</a>.</p>
</div>
<h3 id="experimenting-with-blogs">Experimenting with Blogs</h3>
<h4 id="create-a-blog">Create A Blog</h4>
<p>Lets try to create a new Blog. Use the port given in the browser or console output. Make sure to use authentication!</p>
<p><strong>Request</strong></p>
<pre><code class="lang-rest">POST https://localhost:5001/blog?key=mysecretkey
</code></pre>
<pre><code class="lang-json">{
    &quot;Url&quot;: &quot;http://github.blog/&quot;
}
</code></pre>
<p><strong>Response</strong></p>
<pre><code class="lang-json">{
    &quot;PostId&quot;: 1,
    &quot;Url&quot;: &quot;http://github.blog/&quot;
}
</code></pre>
<div class="TIP">
<h5>Tip</h5>
<p>Since we set the API to <code>WriteJson()</code>, every request will return a JSON representation of the affected models. Try replacing that line with <code>WriteXml()</code> or <code>WriteNumberAffected()</code> instead.</p>
</div>
<h4 id="reading-a-blog">Reading a Blog</h4>
<p>Great! We've just created a new Blog. Let's retrieve it using the <code>PostId</code> returned earlier. We don't need any auth here.</p>
<p><strong>Request</strong></p>
<pre><code class="lang-rest">GET https://localhost:5001/blog/1
</code></pre>
<p><strong>Response</strong></p>
<pre><code class="lang-json">{
    &quot;PostId&quot;: 1,
    &quot;Url&quot;: &quot;http://github.blog/&quot;
}
</code></pre>
<h4 id="updating-a-blog">Updating a Blog</h4>
<p>Uh-oh! We accidentally created the Blog with an insecure, <code>http</code> URL! Let's fix that:</p>
<p><strong>Request</strong></p>
<pre><code class="lang-rest">PUT https://localhost:5001/blog/1?key=mysecretkey
</code></pre>
<pre><code class="lang-json">{
    &quot;Url&quot;: &quot;https://github.blog/&quot;
}
</code></pre>
<p><strong>Response</strong></p>
<pre><code class="lang-json">{
    &quot;PostId&quot;: 1,
    &quot;Url&quot;: &quot;https://github.blog/&quot;
}
</code></pre>
<p>While we're at it, we should probably fix the API to disallow insecure blog urls. Lets do that now by adding options to the <code>PUT</code> request:</p>
<pre><code class='lang-csharp'><span style='color:#222222;'>.</span><span style='color:#795E26;'>PostCreate</span><span style='color:#222222;'>(</span><span style='color:#001080;'>options</span><span style='color:black;'> </span><span style='color:#000000;'>=&gt;</span><span style='color:black;'> </span><span style='color:#222222;'>{</span><br /><span style='color:black;'>    </span><span style='color:#001080;'>options</span><span style='color:#222222;'>.</span><span style='color:#795E26;'>RequireAllInput</span><span style='color:#222222;'>(</span><span style='color:#001080;'>m</span><span style='color:black;'> </span><span style='color:#000000;'>=&gt;</span><span style='color:black;'> </span><span style='color:#001080;'>m</span><span style='color:#222222;'>.</span><span style='color:#001080;'>Url</span><span style='color:#222222;'>.</span><span style='color:#795E26;'>StartsWith</span><span style='color:#222222;'>(</span><span style='color:#A31515;'>&quot;</span><span style='color:#A31515;'>https://</span><span style='color:#A31515;'>&quot;</span><span style='color:#222222;'>)</span><span style='color:#222222;'>)</span><span style='color:#222222;'>;</span><span style='color:black;'> </span><span style='color:#008000;'>//</span><span style='color:#008000;'>todo: custom error messages</span><br /><span style='color:#222222;'>}</span><span style='color:#222222;'>)</span><br /><span style='color:black;'></span></code></pre>
<p>Run the program again and see what happens if you try to create an insecure Blog.</p>
<div class="NOTE">
<h5>Note</h5>
<p>Although it is generally recommended that <code>PUT</code> requests be idempotent, RestModels update operations by default allow partial updates. That is, you don't need to provide all the properties of a model in the request body for an update to be successful. If you would like to instead require all properties be provided, try replacing the update route above with the following:</p>
<pre><code class='lang-csharp'><span style='color:#222222;'>.</span><span style='color:#795E26;'>PutUpdateByPrimaryKey</span><span style='color:#222222;'>(</span><span style='color:#001080;'>update</span><span style='color:black;'> </span><span style='color:#000000;'>=&gt;</span><span style='color:black;'> </span><span style='color:#222222;'>{</span><br /><span style='color:black;'>  </span><span style='color:#001080;'>update</span><br /><span style='color:black;'>      </span><span style='color:#222222;'>.</span><span style='color:#795E26;'>RequireAllProperties</span><span style='color:#222222;'>(</span><span style='color:#222222;'>)</span><span style='color:black;'> </span><span style='color:#008000;'>//</span><span style='color:#008000;'> require every settable property</span><br /><span style='color:black;'>      </span><span style='color:#222222;'>.</span><span style='color:#795E26;'>IgnorePrimaryKey</span><span style='color:#222222;'>(</span><span style='color:#222222;'>)</span><span style='color:#222222;'>;</span><span style='color:black;'> </span><span style='color:#008000;'>//</span><span style='color:#008000;'> except for the primary key, provided in path</span><br /><span style='color:#222222;'>}</span><span style='color:#222222;'>)</span><br /><span style='color:black;'></span></code></pre>
</div>
<h4 id="deleting-a-blog">Deleting a blog</h4>
<p>Finally, lets get rid of the Blog we created:</p>
<p><strong>Request</strong></p>
<pre><code class="lang-rest">DELETE https://localhost:5001/blog/1?key=mysecretkey
</code></pre>
<p><strong>Response</strong></p>
<pre><code class="lang-json">{
    &quot;PostId&quot;: 1,
    &quot;Url&quot;: &quot;https://github.blog/&quot;
}
</code></pre>
<p>By default, the deleted model is returned.</p>
<h2 id="checkpoint">Checkpoint</h2>
<p>You've successfully built your first API with RestModels! If you think you've got the hang of things, and just want to explore, look at <a class="xref" href="../request_flow/index.html">Request Flow</a>. Otherwise, if you want a little more guidance, we still have to build an API for <code>Posts</code>. Let's do that now.</p>
<h2 id="building-the-post-api">Building the <code>Post</code> API</h2>
<p>Let's take this next one step by step.</p>
<p>First, we'll define an API in with it's root at <code>/blog/{id}/posts</code>, and we'll use JSON again to parse and return results.</p>
<div class="tabGroup" id="tabgroup_CeZOj-G++Q-5">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_CeZOj-G++Q-5_cs" role="tab" aria-controls="tabpanel_CeZOj-G++Q-5_cs" data-tab="cs" tabindex="0" aria-selected="true">Startup.cs</a>
</li>
</ul>
<section id="tabpanel_CeZOj-G++Q-5_cs" role="tabpanel" data-tab="cs">

<pre><code class='lang-csharp'><span style='color:#001080;'>app</span><span style='color:#222222;'>.</span><span style='color:#795E26;'>UseEntityFrameworkRestModels</span><span style='color:#222222;'>&lt;</span><span style='color:#267F99;'>Post</span><span style='color:#222222;'>,</span><span style='color:black;'> </span><span style='color:#267F99;'>BlogServerContext</span><span style='color:#222222;'>&gt;</span><span style='color:#222222;'>(</span><span style='color:#A31515;'>&quot;</span><span style='color:#A31515;'>blog/{BlogId:int}/posts/</span><span style='color:#A31515;'>&quot;</span><span style='color:#222222;'>,</span><span style='color:black;'> </span><span style='color:#001080;'>options</span><span style='color:black;'> </span><span style='color:#000000;'>=&gt;</span><span style='color:black;'> </span><span style='color:#222222;'>{</span><br /><span style='color:black;'>    </span><span style='color:#001080;'>options</span><br /><span style='color:black;'>        </span><span style='color:#222222;'>.</span><span style='color:#795E26;'>ParseJson</span><span style='color:#222222;'>(</span><span style='color:#222222;'>)</span><br /><span style='color:black;'>        </span><span style='color:#222222;'>.</span><span style='color:#795E26;'>WriteJson</span><span style='color:#222222;'>(</span><span style='color:#222222;'>)</span><br /><span style='color:#222222;'>}</span><span style='color:#222222;'>)</span><span style='color:#222222;'>;</span><br /><span style='color:black;'></span></code></pre>
</section>
</div>

<p>RestModels uses the routing engine from ASP.NET Core, so you can use the same <a href="https://docs.microsoft.com/en-us/aspnet/core/fundamentals/routing?view=aspnetcore-3.1#route-template-reference">templates</a>.</p>
<p>Next, we'll set up the same CRUD operations from the <code>Blog</code> API. Since we're still developing, we'll leave out <code>CatchExceptions</code> so we can use the default ASP.NET Core exception handler.</p>
<pre><code class='lang-csharp'><span style='color:#001080;'>app</span><span style='color:#222222;'>.</span><span style='color:#795E26;'>UseEntityFrameworkRestModels</span><span style='color:#222222;'>&lt;</span><span style='color:#267F99;'>Post</span><span style='color:#222222;'>,</span><span style='color:black;'> </span><span style='color:#267F99;'>BlogServerContext</span><span style='color:#222222;'>&gt;</span><span style='color:#222222;'>(</span><span style='color:#A31515;'>&quot;</span><span style='color:#A31515;'>blog/{BlogId:int}/posts/</span><span style='color:#A31515;'>&quot;</span><span style='color:#222222;'>,</span><span style='color:black;'> </span><span style='color:#001080;'>options</span><span style='color:black;'> </span><span style='color:#000000;'>=&gt;</span><span style='color:black;'> </span><span style='color:#222222;'>{</span><br /><span style='color:black;'>    </span><span style='color:#001080;'>options</span><br /><span style='color:black;'>        </span><span style='color:#222222;'>.</span><span style='color:#795E26;'>GetByPrimaryKey</span><span style='color:#222222;'>(</span><span style='color:#222222;'>)</span><br /><span style='color:black;'>        </span><span style='color:#222222;'>.</span><span style='color:#795E26;'>AuthQuery</span><span style='color:#222222;'>(</span><span style='color:#A31515;'>&quot;</span><span style='color:#A31515;'>key</span><span style='color:#A31515;'>&quot;</span><span style='color:#222222;'>,</span><span style='color:black;'> </span><span style='color:#001080;'>AdminKey</span><span style='color:#222222;'>)</span><br /><span style='color:black;'>        </span><span style='color:#222222;'>.</span><span style='color:#795E26;'>PostCreate</span><span style='color:#222222;'>(</span><span style='color:#222222;'>)</span><br /><span style='color:black;'>        </span><span style='color:#222222;'>.</span><span style='color:#795E26;'>PutUpdateByPrimaryKey</span><span style='color:#222222;'>(</span><span style='color:#222222;'>)</span><br /><span style='color:black;'>        </span><span style='color:#222222;'>.</span><span style='color:#795E26;'>DeleteByPrimaryKey</span><span style='color:#222222;'>(</span><span style='color:#222222;'>)</span><span style='color:#222222;'>;</span><br /><span style='color:#222222;'>}</span><span style='color:#222222;'>)</span><span style='color:#222222;'>;</span><br /><span style='color:black;'></span></code></pre>
<div class="NOTE">
<h5>Note</h5>
<p>While slashes in the middle of a route pattern are respected, slashes at the beginning and end of route patterns are ignored. That is, <code>blog</code>, <code>/blog</code>, and <code>/blog/</code> are all treated the same way, so feel free to use whatever preference you prefer.</p>
</div>
<p>Since we only want these routes to modify posts from the Blog of the given BlogId route value, we'll add a <a href="xref:filtering">Filter</a>.</p>
<pre><code class='lang-csharp'><span style='color:#001080;'>app</span><span style='color:#222222;'>.</span><span style='color:#795E26;'>UseEntityFrameworkRestModels</span><span style='color:#222222;'>&lt;</span><span style='color:#267F99;'>Post</span><span style='color:#222222;'>,</span><span style='color:black;'> </span><span style='color:#267F99;'>BlogServerContext</span><span style='color:#222222;'>&gt;</span><span style='color:#222222;'>(</span><span style='color:#A31515;'>&quot;</span><span style='color:#A31515;'>blog/{BlogId:int}/posts/</span><span style='color:#A31515;'>&quot;</span><span style='color:#222222;'>,</span><span style='color:black;'> </span><span style='color:#001080;'>options</span><span style='color:black;'> </span><span style='color:#000000;'>=&gt;</span><span style='color:black;'> </span><span style='color:#222222;'>{</span><br /><span style='color:black;'>    </span><span style='color:#001080;'>options</span><br /><span style='color:black;'>        </span><span style='color:#222222;'>.</span><span style='color:#795E26;'>FilterByRouteEqual</span><span style='color:#222222;'>(</span><span style='color:#001080;'>p</span><span style='color:black;'> </span><span style='color:#000000;'>=&gt;</span><span style='color:black;'> </span><span style='color:#001080;'>p</span><span style='color:#222222;'>.</span><span style='color:#001080;'>BlogId</span><span style='color:#222222;'>,</span><span style='color:black;'> </span><span style='color:#A31515;'>&quot;</span><span style='color:#A31515;'>BlogId</span><span style='color:#A31515;'>&quot;</span><span style='color:#222222;'>)</span><br /><span style='color:black;'>        ...</span><br /><span style='color:#222222;'>}</span><span style='color:#222222;'>)</span><span style='color:#222222;'>;</span><br /><span style='color:black;'></span></code></pre>
<div class="NOTE">
<h5>Note</h5>
<p>While filters do operate over the entire dataset provided by EntityFramework, they still use LINQ-to-SQL to keep the API performant.</p>
</div>
<p>It doesn't make sense to filter posts when we're creating a new <code>Post</code>, so lets clear that filter in <code>PostCreate</code>:</p>
<pre><code class='lang-csharp'><span style='color:#001080;'>app</span><span style='color:#222222;'>.</span><span style='color:#795E26;'>UseEntityFrameworkRestModels</span><span style='color:#222222;'>&lt;</span><span style='color:#267F99;'>Post</span><span style='color:#222222;'>,</span><span style='color:black;'> </span><span style='color:#267F99;'>BlogServerContext</span><span style='color:#222222;'>&gt;</span><span style='color:#222222;'>(</span><span style='color:#A31515;'>&quot;</span><span style='color:#A31515;'>blog/{BlogId:int}/posts/</span><span style='color:#A31515;'>&quot;</span><span style='color:#222222;'>,</span><span style='color:black;'> </span><span style='color:#001080;'>options</span><span style='color:black;'> </span><span style='color:#000000;'>=&gt;</span><span style='color:black;'> </span><span style='color:#222222;'>{</span><br /><span style='color:black;'>    </span><span style='color:#001080;'>options</span><br /><span style='color:black;'>        ...</span><br /><span style='color:black;'>        </span><span style='color:#222222;'>.</span><span style='color:#795E26;'>PostCreate</span><span style='color:#222222;'>(</span><span style='color:#001080;'>create</span><span style='color:black;'> </span><span style='color:#000000;'>=&gt;</span><span style='color:black;'> </span><span style='color:#001080;'>create</span><span style='color:#222222;'>.</span><span style='color:#795E26;'>ClearFilters</span><span style='color:#222222;'>(</span><span style='color:#222222;'>)</span><span style='color:#222222;'>)</span><br /><span style='color:black;'>        ...</span><br /><span style='color:#222222;'>}</span><span style='color:#222222;'>)</span><span style='color:#222222;'>;</span><br /><span style='color:black;'></span></code></pre>
<div class="TIP">
<h5>Tip</h5>
<p>Alternatively, you could move the call to <code>PostCreate</code> above the call to <code>FilterByRouteEqual</code> and the filter wouldn't be applied.</p>
</div>
<p>If you try to run it now, <code>POST</code> requests will fail because Entity Framework complains that a foreign key constraint isn't met. Well, we can add that foreign key constraint easily with <code>SetValueRoute</code>, which will set a value for the parsed model before it's created based on that <code>BlogId</code> route value.</p>
<pre><code class='lang-csharp'><span style='color:#001080;'>app</span><span style='color:#222222;'>.</span><span style='color:#795E26;'>UseEntityFrameworkRestModels</span><span style='color:#222222;'>&lt;</span><span style='color:#267F99;'>Post</span><span style='color:#222222;'>,</span><span style='color:black;'> </span><span style='color:#267F99;'>BlogServerContext</span><span style='color:#222222;'>&gt;</span><span style='color:#222222;'>(</span><span style='color:#A31515;'>&quot;</span><span style='color:#A31515;'>blog/{BlogId:int}/posts/</span><span style='color:#A31515;'>&quot;</span><span style='color:#222222;'>,</span><span style='color:black;'> </span><span style='color:#001080;'>options</span><span style='color:black;'> </span><span style='color:#000000;'>=&gt;</span><span style='color:black;'> </span><span style='color:#222222;'>{</span><br /><span style='color:black;'>    </span><span style='color:#001080;'>options</span><br /><span style='color:black;'>        ...</span><br /><span style='color:black;'>        </span><span style='color:#222222;'>.</span><span style='color:#795E26;'>PostCreate</span><span style='color:#222222;'>(</span><span style='color:#001080;'>create</span><span style='color:black;'> </span><span style='color:#000000;'>=&gt;</span><span style='color:black;'> </span><span style='color:#222222;'>{</span><br /><span style='color:black;'>            </span><span style='color:#001080;'>create</span><br /><span style='color:black;'>                </span><span style='color:#222222;'>.</span><span style='color:#795E26;'>ClearFilters</span><span style='color:#222222;'>(</span><span style='color:#222222;'>)</span><br /><span style='color:black;'>                </span><span style='color:#222222;'>.</span><span style='color:#795E26;'>SetValueRoute</span><span style='color:#222222;'>(</span><span style='color:#001080;'>p</span><span style='color:black;'> </span><span style='color:#000000;'>=&gt;</span><span style='color:black;'> </span><span style='color:#001080;'>p</span><span style='color:#222222;'>.</span><span style='color:#001080;'>BlogId</span><span style='color:#222222;'>,</span><span style='color:black;'> </span><span style='color:#A31515;'>&quot;</span><span style='color:#A31515;'>BlogId</span><span style='color:#A31515;'>&quot;</span><span style='color:#222222;'>)</span><span style='color:#222222;'>;</span><br /><span style='color:black;'>        </span><span style='color:#222222;'>}</span><span style='color:#222222;'>)</span><br /><span style='color:black;'>        ...</span><br /><span style='color:#222222;'>}</span><span style='color:#222222;'>)</span><span style='color:#222222;'>;</span><br /><span style='color:black;'></span></code></pre>
<p>We'll also want to add a way to <code>GET</code> all of the posts on a Blog. We can add that functionality on the base route with a simple call.</p>
<pre><code class='lang-csharp'><span style='color:#001080;'>app</span><span style='color:#222222;'>.</span><span style='color:#795E26;'>UseEntityFrameworkRestModels</span><span style='color:#222222;'>&lt;</span><span style='color:#267F99;'>Post</span><span style='color:#222222;'>,</span><span style='color:black;'> </span><span style='color:#267F99;'>BlogServerContext</span><span style='color:#222222;'>&gt;</span><span style='color:#222222;'>(</span><span style='color:#A31515;'>&quot;</span><span style='color:#A31515;'>blog/{BlogId:int}/posts/</span><span style='color:#A31515;'>&quot;</span><span style='color:#222222;'>,</span><span style='color:black;'> </span><span style='color:#001080;'>options</span><span style='color:black;'> </span><span style='color:#000000;'>=&gt;</span><span style='color:black;'> </span><span style='color:#222222;'>{</span><br /><span style='color:black;'>    </span><span style='color:#001080;'>options</span><br /><span style='color:black;'>        ...</span><br /><span style='color:black;'>        </span><span style='color:#222222;'>.</span><span style='color:#795E26;'>Get</span><span style='color:#222222;'>(</span><span style='color:#222222;'>)</span><span style='color:#222222;'>;</span><br /><span style='color:#222222;'>}</span><span style='color:#222222;'>)</span><span style='color:#222222;'>;</span><br /><span style='color:black;'></span></code></pre>
<p>If you're unauthenticated, however, let's make the API return a random blog post. Each of the methods that creates a new route accepts both a route pattern to append to the existing one and an options handler to add additional options. We'll use those here to create a route at <code>blog/{id}/posts/random</code></p>
<pre><code class='lang-csharp'><span style='color:#001080;'>app</span><span style='color:#222222;'>.</span><span style='color:#795E26;'>UseEntityFrameworkRestModels</span><span style='color:#222222;'>&lt;</span><span style='color:#267F99;'>Post</span><span style='color:#222222;'>,</span><span style='color:black;'> </span><span style='color:#267F99;'>BlogServerContext</span><span style='color:#222222;'>&gt;</span><span style='color:#222222;'>(</span><span style='color:#A31515;'>&quot;</span><span style='color:#A31515;'>blog/{BlogId:int}/posts/</span><span style='color:#A31515;'>&quot;</span><span style='color:#222222;'>,</span><span style='color:black;'> </span><span style='color:#001080;'>options</span><span style='color:black;'> </span><span style='color:#000000;'>=&gt;</span><span style='color:black;'> </span><span style='color:#222222;'>{</span><br /><span style='color:black;'>    </span><span style='color:#001080;'>options</span><br /><span style='color:black;'>        ...</span><br /><span style='color:black;'>        </span><span style='color:#222222;'>.</span><span style='color:#795E26;'>SetupAnonymousGet</span><span style='color:#222222;'>(</span><span style='color:#A31515;'>&quot;</span><span style='color:#A31515;'>random</span><span style='color:#A31515;'>&quot;</span><span style='color:#222222;'>,</span><span style='color:black;'> </span><span style='color:#001080;'>random</span><span style='color:black;'> </span><span style='color:#000000;'>=&gt;</span><span style='color:black;'> </span><span style='color:#222222;'>{</span><br /><span style='color:black;'>            </span><span style='color:#001080;'>random</span><span style='color:#222222;'>.</span><span style='color:#795E26;'>Filter</span><span style='color:#222222;'>(</span><span style='color:#001080;'>set</span><span style='color:black;'> </span><span style='color:#000000;'>=&gt;</span><span style='color:black;'> </span><span style='color:#001080;'>set</span><span style='color:#222222;'>.</span><span style='color:#795E26;'>Skip</span><span style='color:#222222;'>(</span><span style='color:#0000FF;'>new</span><span style='color:black;'> </span><span style='color:#267F99;'>Random</span><span style='color:#222222;'>(</span><span style='color:#222222;'>)</span><span style='color:#222222;'>.</span><span style='color:#795E26;'>Next</span><span style='color:#222222;'>(</span><span style='color:#098658;'>0</span><span style='color:#222222;'>,</span><span style='color:black;'> </span><span style='color:#001080;'>set</span><span style='color:#222222;'>.</span><span style='color:#795E26;'>Count</span><span style='color:#222222;'>(</span><span style='color:#222222;'>)</span><span style='color:#222222;'>)</span><span style='color:#222222;'>)</span><span style='color:#222222;'>)</span><br /><span style='color:black;'>                </span><span style='color:#222222;'>.</span><span style='color:#795E26;'>LimitOne</span><span style='color:#222222;'>(</span><span style='color:#222222;'>)</span><span style='color:#222222;'>;</span><br /><span style='color:black;'>        </span><span style='color:#222222;'>}</span><span style='color:#222222;'>)</span><span style='color:#222222;'>;</span><br /><span style='color:#222222;'>}</span><span style='color:#222222;'>)</span><span style='color:#222222;'>;</span><br /><span style='color:black;'></span></code></pre>
<div class="TIP">
<h5>Tip</h5>
<p>The <code>Blog</code> property will always be null on returned posts because of how Entity Framework works. Use <a class="xref" href="../../api/RestModels.Options.Builder.RestModelOptionsBuilder-2.html#RestModels_Options_Builder_RestModelOptionsBuilder_2_Omit_System_Linq_Expressions_Expression_System_Func__0_System_Object___">Omit(Expression&lt;Func&lt;TModel, Object&gt;&gt;)</a> to hide it.</p>
</div>
<h2 id="wrapping-up">Wrapping Up</h2>
<p>Run the project again and play around with creating blogs, creating, updating, deleting posts in a blog, getting all posts, and getting a random post.</p>
<p>Congratulations! You've built two APIs with RestModels in less than 30 lines of code! These getting started guides provide a small taste of what RestModels can do.</p>
<p>If you're still eager to learn more, check out the following resources:</p>
<ul>
<li><a class="xref" href="../request_flow/index.html">The Request Flow</a>. A closer look at the architecture of RestModels.</li>
<li><a href="xref:api-examples">More Examples</a>. RestModels hides a lot of power in a small library. The best way to make full use of it is by exploring examples.</li>
</ul>
</article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                  <li>
                    <a href="https://github.com/jlynch630/RestModels/blob/master/docs-src/docfx_project/articles/getting_started/efcore.md/#L1" class="contribution-link">Improve this Doc</a>
                  </li>
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
              
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            
            <span>Generated by <strong>DocFX</strong></span>
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../styles/main.js"></script>
  </body>
</html>
